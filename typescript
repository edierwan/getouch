Script started on Tue Feb 17 18:19:58 2026
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  scp /tmp/scan_encrypted.php deploy@ [K1100.103.248.15:/tmp/scan_encrypted.php[?2004l
scan_encrypted.php                         0%    0     0.0KB/s   --:-- ETAscan_encrypted.php                       100% 1315   155.3KB/s   00:00    
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 'docker c [Kpp /tmp/scan_encrypted.php coolify:/tmp/scan_encrypted.php && docker exec co [Koolify php artisan tinker /tmp/scan_encrypted.php'[?2004l
Restricted Mode: skipping untrusted project features from /var/www/html (non-interactive mode). Use --trust-project to allow.
[applications.http_basic_auth_password] no data
[cloud_init_scripts.script] no data
[cloud_provider_tokens.token] no data
[discord_notification_settings.discord_webhook_url] no data
[email_notification_settings.smtp_from_address] no data
[email_notification_settings.smtp_from_name] no data
[email_notification_settings.smtp_recipients] no data
[email_notification_settings.smtp_host] no data
[email_notification_settings.smtp_username] no data
[email_notification_settings.smtp_password] no data
[email_notification_settings.resend_api_key] no data
[environment_variables.value] no data
[instance_settings.smtp_from_address] no data
[instance_settings.smtp_from_name] no data
[instance_settings.smtp_recipients] no data
[instance_settings.smtp_host] no data
[instance_settings.smtp_username] no data
[instance_settings.smtp_password] no data
[instance_settings.resend_api_key] no data
[instance_settings.sentinel_token] query error: SQLSTATE[42703]: Undefined column: 7 ERROR:  column "sentinel_token" does not ex
[local_file_volumes.fs_path] no data
[local_file_volumes.mount_path] no data
[local_file_volumes.content] no data
[private_keys.private_key] id=0 OK
[pushover_notification_settings.pushover_user_key] no data
[pushover_notification_settings.pushover_api_token] no data
[s3_storages.key] no data
[s3_storages.secret] no data
[servers.logdrain_axiom_api_key] query error: SQLSTATE[42703]: Undefined column: 7 ERROR:  column "logdrain_axiom_api_key" doe
[servers.logdrain_newrelic_license_key] query error: SQLSTATE[42703]: Undefined column: 7 ERROR:  column "logdrain_newrelic_license_k
[server_settings.sentinel_token] id=2 OK
[server_settings.sentinel_token] id=1 OK
[shared_environment_variables.value] no data
[slack_notification_settings.slack_webhook_url] no data
[ssl_certificates.ssl_certificate] id=1 FAILED: The MAC is invalid.
[ssl_certificates.ssl_private_key] id=1 FAILED: The MAC is invalid.
[standalone_clickhouses.clickhouse_password] query error: SQLSTATE[42703]: Undefined column: 7 ERROR:  column "clickhouse_password" does n
[standalone_dragonflies.dragonfly_password] no data
[standalone_keydbs.keydb_password] no data
[standalone_mariadbs.mariadb_password] no data
[standalone_mysqls.mysql_password] no data
[standalone_mysqls.mysql_root_password] no data
[standalone_postgresqls.postgres_password] no data
[telegram_notification_settings.telegram_token] no data
[telegram_notification_settings.telegram_chat_id] no data
[telegram_notification_settings.telegram_notifications_deployment_success_thread_id] no data
[telegram_notification_settings.telegram_notifications_deployment_failure_thread_id] no data
[telegram_notification_settings.telegram_notifications_status_change_thread_id] no data
[telegram_notification_settings.telegram_notifications_backup_success_thread_id] no data
[telegram_notification_settings.telegram_notifications_backup_failure_thread_id] no data
[telegram_notification_settings.telegram_notifications_scheduled_task_success_thread_id] no data
[telegram_notification_settings.telegram_notifications_scheduled_task_failure_thread_id] no data
[telegram_notification_settings.telegram_notifications_docker_cleanup_thread_id] query error: SQLSTATE[42703]: Undefined column: 7 ERROR:  column "telegram_notifications_dock
[telegram_notification_settings.telegram_notifications_server_disk_usage_thread_id] no data
[telegram_notification_settings.telegram_notifications_server_reachable_thread_id] no data
[telegram_notification_settings.telegram_notifications_server_unreachable_thread_id] no data
[telegram_notification_settings.telegram_notifications_server_patch_thread_id] no data
[telegram_notification_settings.telegram_notifications_traefik_outdated_thread_id] no data
[webhook_notification_settings.webhook_url] no data
--- SCAN COMPLETE ---
> [1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify php artisan tinker --execute=\"[?2004l
[0m[27m[24m[Jdquote> [K[?2004huuse Illuminate\Support\Facades\DB;[?2004l
[0m[27m[24m[Jdquote> [K[?2004h\\\\$row = DB::table('ssl_certificates')->where('id', 1)->first();[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'SSL cert id=1 details:' . PHP_EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'domain: ' . (\\\$row->domain ?? 'NULL') . PHP_EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'cert length: ' . strlen(\\\$row->ssl_certificate ?? '') . PHP [K__EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'key length: ' . strlen(\\\$row->ssl_private_key ?? '') . PHP_ [KEEOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'type: ' . (\\\$row->type ?? 'NULL') . PHP_EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'created: ' . (\\\$row->created_at ?? 'NULL') . PHP_EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004h\\""[?2004l
Restricted Mode: skipping untrusted project features from /var/www/html (non-interactive mode). Use --trust-project to allow.
SSL cert id=1 details:
domain: NULL
cert length: 1764
key length: 884
type: NULL
created: 2026-02-16 17:36:32
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify php artisan tinker --execute=\"[?2004l
[0m[27m[24m[Jdquote> [K[?2004huuse Illuminate\Support\Facades\DB;[?2004l
[0m[27m[24m[Jdquote> [K[?2004h\\\\$deleted = DB::table('ssl_certificates')->where('id', 1)->delete [K(();[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'Deleted: ' . \\\$deleted . ' row(s)' . PHP_EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'Remaining certs: ' . DB::table('ssl_certificates')->count() . [K  PHP_EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004h\\""[?2004l
Restricted Mode: skipping untrusted project features from /var/www/html (non-interactive mode). Use --trust-project to allow.
Deleted: 1 row(s)
Remaining certs: 0
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify php artisan cache:clear && docker exec coolify php artisan conf [Kiig:clear && docker exec coolify php artisan view:clear && docker exec cooli [Kffy php artisan route:clear && echo '--- ALL CACHES CLEARED ---'"[?2004l

   INFO  Application cache cleared successfully.  


   INFO  Configuration cache cleared successfully.  


   INFO  Compiled views cleared successfully.  


   INFO  Route cache cleared successfully.  

--- ALL CACHES CLEARED ---
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "cat /opt [K//getouch/config/Caddyfile"[?2004l
# Getouch Platform â€” Caddy Reverse Proxy Configuration
# Cloudflare handles TLS at edge; Caddy receives plain HTTP from cloudflared.
# Security headers applied globally via snippet.

{
	auto_https off
}

# â”€â”€ Security Headers Snippet â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(security_headers) {
	header {
		X-Content-Type-Options    "nosniff"
		X-Frame-Options           "SAMEORIGIN"
		Referrer-Policy           "strict-origin-when-cross-origin"
		Permissions-Policy        "camera=(), microphone=(), geolocation=(), payment=()"
		X-XSS-Protection          "1; mode=block"
		-Server
	}
}

# â”€â”€ Stricter CSP for admin / internal pages â”€â”€
(admin_csp) {
	header {
		Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'self'"
	}
}

# â”€â”€ Catch-all â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
:80 {
	respond "getouch platform" 200
}

# â”€â”€ Landing â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
getouch.co:80 {
	import security_headers
	reverse_proxy landing:3000
}

# â”€â”€ Bot Chatbot â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
bot.getouch.co:80 {
	import security_headers
	reverse_proxy bot:3000
}

# â”€â”€ WhatsApp Gateway â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
wa.getouch.co:80 {
	import security_headers

	route /v1/* {
		reverse_proxy landing:3000
	}
	reverse_proxy wa:3000
}

# â”€â”€ API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
api.getouch.co:80 {
	import security_headers

	handle /api/internal/* {
		import admin_csp
		reverse_proxy api:3000
	}
	handle {
		reverse_proxy api:3000
	}
}

# â”€â”€ pgAdmin â€” Cloudflare Access protected (SSO via auth proxy) â”€â”€â”€â”€
db.getouch.co:80 {
	import security_headers

	reverse_proxy pgadmin:5050 {
		# Standard header name (hyphens, no underscores) for reliable passthrough
		header_up X-Forwarded-User "{http.request.header.Cf-Access-Authenticated-User-Email}"
		# Also pass REMOTE_USER for compatibility
		header_up REMOTE_USER "{http.request.header.Cf-Access-Authenticated-User-Email}"
		# Let pgAdmin know it's behind a proxy
		header_up X-Forwarded-Proto "https"
		header_up X-Script-Name ""
	}
}

# â”€â”€ Grafana â€” Cloudflare Access protected (SSO via auth proxy) â”€â”€â”€â”€
grafana.getouch.co:80 {
	import security_headers

	handle {
		reverse_proxy grafana:3000 {
			# Copy CF Access identity into the header Grafana reads
			header_up X-WEBAUTH-USER "{http.request.header.Cf-Access-Authenticated-User-Email}"
		}
	}
}

# â”€â”€ Prometheus â€” Cloudflare Access protected â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
metrics.getouch.co:80 {
	import security_headers
	import admin_csp
	reverse_proxy prometheus:9090
}

# â”€â”€ Coolify â€” Cloudflare Access protected â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# NOTE: Coolify has its own Laravel auth system. CF Access protects the route,
# but users must log in to Coolify once. Session persists in browser.
coolify.getouch.co:80 {
	import security_headers

	# WebSocket real-time (Soketi) â€” matches Pusher protocol paths
	handle /app/* {
		reverse_proxy coolify-realtime:6001
	}
	handle /apps/* {
		reverse_proxy coolify-realtime:6001
	}

	# Terminal WebSocket â€” container exec terminal
	handle /terminal/ws {
		reverse_proxy coolify-realtime:6002
	}

	# Everything else â†’ Coolify Laravel app
	handle {
		reverse_proxy coolify:8080
	}
}


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STAGING â€” develop branch â†’ dev.getouch.co â†’ postgres-ssd
# Containers: landing-stg, bot-stg, wa-stg, api-stg
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# â”€â”€ Dev Landing â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
dev.getouch.co:80 {
	import security_headers
	reverse_proxy landing-stg:3000
}

# â”€â”€ Dev Bot â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
bot.dev.getouch.co:80 {
	import security_headers
	reverse_proxy bot-stg:3000
}

# â”€â”€ Dev WhatsApp â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
wa.dev.getouch.co:80 {
	import security_headers
	reverse_proxy wa-stg:3000
}

# â”€â”€ Dev API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
api.dev.getouch.co:80 {
	import security_headers
	reverse_proxy api-stg:3000
}

[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify grep -r 'terminal' /var/www/html/resources/js/ --include='*.js' [K  --include='*.ts' -l 2>/dev/null | head -10"[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify grep -rl 'terminal\|Terminal\|websocket\|WebSocket' /var/www/ht [Kmml/resources/ 2>/dev/null | head -20"[?2004l
/var/www/html/resources/views/components/navbar.blade.php
/var/www/html/resources/views/components/resources/breadcrumbs.blade.php
/var/www/html/resources/views/components/server/sidebar-security.blade.php
/var/www/html/resources/views/livewire/project/service/heading.blade.php
/var/www/html/resources/views/livewire/project/resource/index.blade.php
/var/www/html/resources/views/livewire/project/shared/terminal.blade.php
/var/www/html/resources/views/livewire/project/shared/execute-container-command.blade.php
/var/www/html/resources/views/livewire/project/application/heading.blade.php
/var/www/html/resources/views/livewire/project/database/heading.blade.php
/var/www/html/resources/views/livewire/terminal/index.blade.php
/var/www/html/resources/views/livewire/server/navbar.blade.php
/var/www/html/resources/views/livewire/server/security/terminal-access.blade.php
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify cat /var/www/html/resources/views/livewire/terminal/index.blade [K..php"[?2004l
<div>
    <x-slot:title>
        Terminal | Coolify
        </x-slot>
        <h1>Terminal</h1>
        <div class="flex gap-2 items-end subtitle">
            <div>Execute commands on your servers and containers without leaving the browser.</div>
            <x-helper
                helper="If you're having trouble connecting to your server, make sure that the port is open.<br><br><a class='underline' href='https://coolify.io/docs/knowledge-base/server/firewall/#terminal' target='_blank'>Documentation</a>"></x-helper>
        </div>
        <div x-init="$wire.loadContainers()">
            @if ($isLoadingContainers)
                <div class="pt-1">
                    <x-loading text="Loading servers and containers..." />
                </div>
            @else
                @if ($servers->count() > 0)
                    <form class="flex flex-col gap-2 justify-center xl:items-end xl:flex-row"
                        wire:submit="$dispatchSelf('connectToContainer')">
                        <x-forms.select id="selected_uuid" required wire:model.live="selected_uuid">
                            <option value="default">Select a server or container</option>
                            @foreach ($servers as $server)
                                <option value="{{ $server->uuid }}">{{ $server->name }}</option>
                                @foreach ($containers as $container)
                                    @if ($container['server_uuid'] == $server->uuid)
                                        <option value="{{ $container['uuid'] }}">
                                            {{ $server->name }} -> {{ $container['name'] }}
                                        </option>
                                    @endif
                                @endforeach
                            @endforeach
                        </x-forms.select>
                        <x-forms.button type="submit">Connect</x-forms.button>
                    </form>
                @else
                    <div>No servers with terminal access found.</div>
                @endif
            @endif
            <livewire:project.shared.terminal />
        </div>
</div>[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify cat /var/www/html/resources/views/livewire/project/shared/termi [Knnal.blade.php"[?2004l
<div id="terminal-container" x-data="terminalData()">
    @if (!$hasShell)
        <div class="flex pt-4 items-center justify-center w-full py-4 mx-auto">
            <div class="p-4 w-full rounded-sm border dark:bg-coolgray-100 dark:border-coolgray-300">
                <div class="flex flex-col items-center justify-center space-y-4">
                    <svg class="w-12 h-12 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                    </svg>
                    <div class="text-center">
                        <h3 class="text-lg font-medium">Terminal Not Available</h3>
                        <p class="mt-2 text-sm text-neutral-300">No shell (bash/sh) is available in this container.
                            Please
                            ensure either bash or sh is installed to use the terminal.</p>
                    </div>
                </div>
            </div>
        </div>
    @endif
    <div x-ref="terminalWrapper"
        :class="fullscreen ? 'fullscreen !bg-black' : 'relative w-full h-full py-4 mx-auto max-h-[510px]'">
        <!-- Terminal container -->
        <div id="terminal" wire:ignore
            :class="fullscreen ? 'px-2 py-1 h-full bg-black' : 'px-2 py-1 rounded-sm bg-black'" x-show="terminalActive">
        </div>
        <button title="Minimize" x-show="fullscreen" class="fixed bg-black/40 top-4 right-6 text-white"
            x-on:click="makeFullscreen"><svg class="w-5 h-5 text-gray-500 hover:text-white bg-black/80"
                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                    stroke-width="2" d="M6 14h4m0 0v4m0-4l-6 6m14-10h-4m0 0V6m0 4l6-6" />
            </svg></button>
        <button title="Fullscreen" x-show="!fullscreen && terminalActive" class="absolute right-5 top-6 text-white "
            x-on:click="makeFullscreen"> <svg class="w-5 h-5 text-gray-500 hover:text-white bg-black/80"
                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <g fill="none">
                    <path
                        d="M24 0v24H0V0h24ZM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018Zm.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01l-.184-.092Z" />
                    <path fill="currentColor"
                        d="M9.793 12.793a1 1 0 0 1 1.497 1.32l-.083.094L6.414 19H9a1 1 0 0 1 .117 1.993L9 21H4a1 1 0 0 1-.993-.883L3 20v-5a1 1 0 0 1 1.993-.117L5 15v2.586l4.793-4.793ZM20 3a1 1 0 0 1 .993.883L21 4v5a1 1 0 0 1-1.993.117L19 9V6.414l-4.793 4.793a1 1 0 0 1-1.497-1.32l.083-.094L17.586 5H15a1 1 0 0 1-.117-1.993L15 3h5Z" />
                </g>
            </svg></button>
    </div>
    @script
        <script>
            // expose terminal config to the terminal.js file
            window.terminalConfig = {
                protocol: "{{ config('constants.terminal.protocol') }}",
                host: "{{ config('constants.terminal.host') }}",
                port: "{{ config('constants.terminal.port') }}"
            }
        </script>
    @endscript
</div>
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify grep -r 'terminal' /var/www/html/config/constants.php 2>/dev/nu [Klll; docker exec coolify cat /var/www/html/config/constants.php | head -50"[?2004l
    'terminal' => [
<?php

return [
    'coolify' => [
        'version' => '4.0.0-beta.463',
        'helper_version' => '1.0.12',
        'realtime_version' => '1.0.10',
        'self_hosted' => env('SELF_HOSTED', true),
        'autoupdate' => env('AUTOUPDATE'),
        'base_config_path' => env('BASE_CONFIG_PATH', '/data/coolify'),
        'registry_url' => env('REGISTRY_URL', 'ghcr.io'),
        'helper_image' => env('HELPER_IMAGE', env('REGISTRY_URL', 'ghcr.io').'/coollabsio/coolify-helper'),
        'realtime_image' => env('REALTIME_IMAGE', env('REGISTRY_URL', 'ghcr.io').'/coollabsio/coolify-realtime'),
        'is_windows_docker_desktop' => env('IS_WINDOWS_DOCKER_DESKTOP', false),
        'cdn_url' => env('CDN_URL', 'https://cdn.coollabs.io'),
        'versions_url' => env('VERSIONS_URL', env('CDN_URL', 'https://cdn.coollabs.io').'/coolify/versions.json'),
        'upgrade_script_url' => env('UPGRADE_SCRIPT_URL', env('CDN_URL', 'https://cdn.coollabs.io').'/coolify/upgrade.sh'),
        'releases_url' => 'https://cdn.coolify.io/releases.json',
    ],

    'urls' => [
        'docs' => 'https://coolify.io/docs',
        'contact' => 'https://coolify.io/docs/contact',
    ],

    'services' => [
        // Temporary disabled until cache is implemented
        // 'official' => 'https://cdn.coollabs.io/coolify/service-templates.json',
        'official' => 'https://raw.githubusercontent.com/coollabsio/coolify/v4.x/templates/service-templates-latest.json',
        'file_name' => 'service-templates-latest.json',
    ],

    'terminal' => [
        'protocol' => env('TERMINAL_PROTOCOL'),
        'host' => env('TERMINAL_HOST'),
        'port' => env('TERMINAL_PORT'),
    ],

    'pusher' => [
        'host' => env('PUSHER_HOST'),
        'port' => env('PUSHER_PORT'),
        'app_key' => env('PUSHER_APP_KEY'),
    ],

    'migration' => [
        'is_migration_enabled' => env('MIGRATION_ENABLED', true),
    ],

    'seeder' => [
        'is_seeder_enabled' => env('SEEDER_ENABLED', true),
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify env | grep -i 'TERMINAL\|PUSHER'"[?2004l
TERMINAL_PORT=
TERMINAL_HOST=
PUSHER_APP_ID=coolify
PUSHER_APP_KEY=coolify
PUSHER_SCHEME=http
PUSHER_APP_SECRET=coolify
TERMINAL_PROTOCOL=wss
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify find /var/www/html/resources/js -name '*terminal*' -o -name '*T [Keerminal*' 2>/dev/null; docker exec coolify find /var/www/html/public -name  [K''*terminal*' 2>/dev/null"[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify grep -rl 'terminal\|WebSocket.*6002\|terminalConfig' /var/www/h [Kttml/resources/js/ /var/www/html/public/build/ 2>/dev/null | head -10"[?2004l
/var/www/html/public/build/assets/app-BNvJoPaw.js
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify grep -o 'terminalConfig[^;]*\|terminal[A-Za-z]*[^;]*ws[^;]*\|ne [Kww WebSocket[^;]*' /var/www/html/public/build/assets/app-BNvJoPaw.js | head  [K--20"[?2004l
terminal=e,this._coreBrowserService=a,this._renderService=f,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[]
terminal.rows
terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize((_=>this._handleResize(_.rows)))),this.register(this._terminal.onRender((_=>this._refreshRows(_.start,_.end)))),this.register(this._terminal.onScroll((()=>this._refreshRows()))),this.register(this._terminal.onA11yChar((_=>this._handleChar(_)))),this.register(this._terminal.onLineFeed((()=>this._handleChar(`
terminal.onA11yTab((_=>this._handleTab(_)))),this.register(this._terminal.onKey((_=>this._handleKey(_.key)))),this.register(this._terminal.onBlur((()=>this._clearLiveRegion()))),this.register(this._renderService.onDimensionsChange((()=>this._refreshRowsDimensions()))),this.register((0,i.addDisposableDomListener)(document,"selectionchange",(()=>this._handleSelectionChange()))),this.register(this._coreBrowserService.onDprChange((()=>this._refreshRowsDimensions()))),this._refreshRows(),this.register((0,v.toDisposable)((()=>{this._accessibilityContainer.remove(),this._rowElements.length=0})))}_handleTab(e){for(let t=0
terminal.rows)}_renderRows(e,t){const a=this._terminal.buffer,f=a.lines.length.toString()
terminal.rows
terminal.rows&&this._handleResize(this._terminal.rows)
terminal.rows
terminal=b,this._document=A,this._element=M,this._screenElement=P,this._viewportElement=N,this._helperContainer=I,this._linkifier2=S,this._charSizeService=y,this._optionsService=D,this._bufferService=B,this._coreBrowserService=H,this._themeService=$,this._terminalClass=k++,this._rowElements=[],this._selectionRenderModel=(0,h.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new e.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(_),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(E),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,g.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange((()=>this._handleOptionsChanged()))),this.register(this._themeService.onChangeColors((z=>this._injectCss(z)))),this._injectCss(this._themeService.colors),this._rowFactory=w.createInstance(n.DomRendererRowFactory,document),this._element.classList.add(f+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline((z=>this._handleLinkHover(z)))),this.register(this._linkifier2.onHideLinkUnderline((z=>this._handleLinkLeave(z)))),this.register((0,t.toDisposable)((()=>{this._element.classList.remove(f+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))),this._widthCache=new d.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const b=this._coreBrowserService.dpr
terminal||isNaN(q.cols)||isNaN(q.rows))return
terminal.rows===q.rows&&this._terminal.cols===q.cols||(Z._renderService.clear(),this._terminal.resize(q.cols,q.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return
terminalActive",U=>{!U&&this.keepAliveInterval&&clearInterval(this.keepAliveInterval),this.$nextTick(()=>{U?(this.$refs.terminalWrapper.style.display="block",this.resizeTerminal(),this.resizeObserver&&this.$refs.terminalWrapper&&this.resizeObserver.observe(this.$refs.terminalWrapper)):(this.$refs.terminalWrapper.style.display="none",this.resizeObserver&&this.resizeObserver.disconnect())})}),["livewire:navigated","beforeunload"].forEach(U=>{document.addEventListener(U,()=>{this.cleanup()},{once:!0})}),document.addEventListener("visibilitychange",()=>{this.handleVisibilityChange()}),window.onresize=()=>{this.resizeTerminal()},window.ResizeObserver&&(this.resizeObserver=new ResizeObserver(()=>{clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{this.resizeTerminal()},50)}))},cleanup(){this.checkIfProcessIsRunningAndKillIt(),this.clearAllTimers(),this.connectionState="disconnected",this.socket&&this.socket.close(1e3,"Client cleanup"),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.resizeTimeout&&clearTimeout(this.resizeTimeout)},clearAllTimers(){[this.keepAliveInterval,this.reconnectInterval,this.connectionTimeoutId,this.pingTimeoutId,this.resizeTimeout].forEach(U=>U&&clearInterval(U)),this.keepAliveInterval=null,this.reconnectInterval=null,this.connectionTimeoutId=null,this.pingTimeoutId=null,this.resizeTimeout=null},resetTerminal(){this.term&&(this.$wire.dispatch("error","Terminal websocket connection lost."),this.term.reset(),this.term.clear(),this.pendingWrites=0,this.paused=!1,this.commandBuffer="",this.$wire.dispatch("terminalDisconnected"),this.$nextTick(()=>{this.resizeTerminal(),this.term.focus()}))},setupTerminal(){document.getElementById("terminal")&&(this.term=new we.Terminal({cols:80,rows:30,fontFamily:'"Fira Code", courier-new, courier, monospace, "Powerline Extra Symbols"',cursorBlink:!0,rendererType:"canvas",convertEol:!0,disableStdin:!1}),this.fitAddon=new Ee.FitAddon,this.term.loadAddon(this.fitAddon),this.$nextTick(()=>{this.resizeTerminal()}))},initializeWebSocket(){if(this.socket&&this.socket.readyState!==WebSocket.CLOSED){console.log("[Terminal] WebSocket already connecting/connected, skipping")
terminalConfig||(console.warn("[Terminal] Terminal config not available, using defaults"),window.terminalConfig={})
terminalConfig,V={protocol:window.location.protocol==="https:"?"wss":"ws",host:window.location.hostname,port:":6002",path:"/terminal/ws"}
new WebSocket(Y)
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify grep -oP 'initializeWebSocket.{0,1500}' /var/www/html/public/bu [Kiild/assets/app-BNvJoPaw.js | head -1"[?2004l
grep: unrecognized option: P
BusyBox v1.37.0 (2025-12-16 14:19:28 UTC) multi-call binary.

Usage: grep [-HhnlLoqvsrRiwFE] [-m N] [-A|B|C N] { PATTERN | -e PATTERN... | -f FILE... } [FILE]...

Search for PATTERN in FILEs (or stdin)

	-H	Add 'filename:' prefix
	-h	Do not add 'filename:' prefix
	-n	Add 'line_no:' prefix
	-l	Show only names of files that match
	-L	Show only names of files that don't match
	-c	Show only count of matching lines
	-o	Show only the matching part of line
	-q	Quiet. Return 0 if PATTERN is found, 1 otherwise
	-v	Select non-matching lines
	-s	Suppress open and read errors
	-r	Recurse
	-R	Recurse and dereference symlinks
	-i	Ignore case
	-w	Match whole words only
	-x	Match whole lines only
	-F	PATTERN is a literal (not regexp)
	-E	PATTERN is an extended regexp
	-m N	Match up to N times per file
	-A N	Print N lines of trailing context
	-B N	Print N lines of leading context
	-C N	Same as '-A N -B N'
	-e PTRN	Pattern to match
	-f FILE	Read pattern from file
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify grep -o 'initializeWebSocket.\{0,2000\}' /var/www/html/public/b [Kuuild/assets/app-BNvJoPaw.js" 2>&1 | head -60[?2004l
grep: bad regex 'initializeWebSocket.\{0,2000\}': Invalid contents of {}
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 'docker e [Kxxec coolify grep -oE "initializeWebSocket.{0,2000}" /var/www/html/public/bu [Kiild/assets/app-BNvJoPaw.js' 2>&1 | head -60[?2004l
grep: bad regex 'initializeWebSocket.{0,2000}': Invalid contents of {}
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 'docker e [Kxxec coolify sed -n "s/.*\(initializeWebSocket.*new WebSocket[^)]*)\).*/\1/p [K"" /var/www/html/public/build/assets/app-BNvJoPaw.js'[?2004l
initializeWebSocket(){if(this.socket&&this.socket.readyState!==WebSocket.CLOSED){console.log("[Terminal] WebSocket already connecting/connected, skipping");return}this.connectionState="connecting",this.clearAllTimers(),window.terminalConfig||(console.warn("[Terminal] Terminal config not available, using defaults"),window.terminalConfig={});const U=window.terminalConfig,V={protocol:window.location.protocol==="https:"?"wss":"ws",host:window.location.hostname,port:":6002",path:"/terminal/ws"};window.location.port||(V.port=""),U.host&&(V.host=U.host),U.port&&(V.port=`:${U.port}`),U.protocol&&(V.protocol=U.protocol);const Y=`${V.protocol}://${V.host}${V.port}${V.path}`;console.log(`[Terminal] Attempting connection to: ${Y}`);try{this.socket=new WebSocket(Y)
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify-realtime netstat -tlnp 2>/dev/null || docker exec coolify-realt [Kiime ss -tlnp 2>/dev/null || docker exec coolify-realtime cat /proc/net/tcp  [K22>/dev/null | head -5; docker logs coolify-realtime --tail 30 2>&1"[?2004l
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 0.0.0.0:9601            0.0.0.0:*               LISTEN      8/soketi-server
tcp        0      0 0.0.0.0:6001            0.0.0.0:*               LISTEN      8/soketi-server
tcp        0      0 127.0.0.11:36789        0.0.0.0:*               LISTEN      -
tcp        0      0 :::6002                 :::*                    LISTEN      7/node
2026-02-17 09:48:44 [TERMINAL] Coolify realtime terminal server listening on port 6002. Let the hacking begin!
2026-02-17 09:48:44 [SOKETI] 
2026-02-17 09:48:44 [SOKETI] ðŸ•µï¸â€â™‚ï¸ Initiating metrics endpoints...
2026-02-17 09:48:44 [SOKETI] 
2026-02-17 09:48:44 [SOKETI] ðŸŽ‰ Server is up and running!
2026-02-17 09:48:44 [SOKETI] ðŸ“¡ The Websockets server is available at 127.0.0.1:6001
2026-02-17 09:48:44 [SOKETI] ðŸ”— The HTTP API server is available at http://127.0.0.1:6001
2026-02-17 09:48:44 [SOKETI] ðŸŽŠ The /usage endpoint is available on port 9601.
2026-02-17 09:48:44 [SOKETI] 
2026-02-17 09:48:44 [SOKETI] (node:8) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.
2026-02-17 09:48:44 [SOKETI] 
2026-02-17 09:48:44 [SOKETI] Please migrate your code to use AWS SDK for JavaScript (v3).
2026-02-17 09:48:44 [SOKETI] For more information, check the migration guide at https://a.co/7PzMCcy
2026-02-17 09:48:44 [SOKETI] (Use `node --trace-warnings ...` to show where the warning was created)
2026-02-17 10:09:23 [TERMINAL] Authentication error: Request failed with status code 419
2026-02-17 10:09:24 [TERMINAL] Authentication error: Request failed with status code 419
2026-02-17 10:09:27 [TERMINAL] Authentication error: Request failed with status code 419
2026-02-17 10:09:32 [TERMINAL] Authentication error: Request failed with status code 419
2026-02-17 10:09:41 [TERMINAL] Authentication error: Request failed with status code 419
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify-realtime env | sort"[?2004l
HOME=/root
HOSTNAME=c1ff84669edf
NODE_VERSION=16.20.2
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
SOKETI_DEBUG=false
SOKETI_DEFAULT_APP_ID=coolify
SOKETI_DEFAULT_APP_KEY=coolify
SOKETI_DEFAULT_APP_SECRET=coolify
SOKETI_METRICS_ENABLED=false
SOKETI_PORT=6001
YARN_VERSION=1.22.19
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify-realtime find / -name 'terminal*' -type f 2>/dev/null | head -1 [K00; docker exec coolify-realtime ls /app/ 2>/dev/null || docker exec coolify [K--realtime ls / 2>/dev/null | head -20"[?2004l
/terminal/terminal-server.js
/terminal/node_modules/node-pty/lib/terminal.test.js.map
/terminal/node_modules/node-pty/lib/terminal.js
/terminal/node_modules/node-pty/lib/terminal.js.map
/terminal/node_modules/node-pty/lib/terminal.test.js
/terminal/node_modules/node-pty/src/terminal.ts
/terminal/node_modules/node-pty/src/terminal.test.ts
/app/node_modules/blessed/lib/widgets/terminal.js
LICENSE
README.md
bin
dist
node_modules
package-lock.json
package.json
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify-realtime cat /terminal/terminal-server.js"[?2004l
import { WebSocketServer } from 'ws';
import http from 'http';
import pty from 'node-pty';
import axios from 'axios';
import cookie from 'cookie';
import 'dotenv/config'

const server = http.createServer((req, res) => {
    if (req.url === '/ready') {
        res.writeHead(200, { 'Content-Type': 'text/plain' });
        res.end('OK');
    } else {
        res.writeHead(404, { 'Content-Type': 'text/plain' });
        res.end('Not Found');
    }
});

const verifyClient = async (info, callback) => {
    const cookies = cookie.parse(info.req.headers.cookie || '');
    // const origin = new URL(info.origin);
    // const protocol = origin.protocol;
    const xsrfToken = cookies['XSRF-TOKEN'];

    // Generate session cookie name based on APP_NAME
    const appName = process.env.APP_NAME || 'laravel';
    const sessionCookieName = `${appName.replace(/[^a-zA-Z0-9]/g, '_').toLowerCase()}_session`;
    const laravelSession = cookies[sessionCookieName];

    // Verify presence of required tokens
    if (!laravelSession || !xsrfToken) {
        return callback(false, 401, 'Unauthorized: Missing required tokens');
    }

    try {
        // Authenticate with Laravel backend
        const response = await axios.post(`http://coolify:8080/terminal/auth`, null, {
            headers: {
                'Cookie': `${sessionCookieName}=${laravelSession}`,
                'X-XSRF-TOKEN': xsrfToken
            },
        });

        if (response.status === 200) {
            // Authentication successful
            callback(true);
        } else {
            callback(false, 401, 'Unauthorized: Invalid credentials');
        }
    } catch (error) {
        console.error('Authentication error:', error.message);
        callback(false, 500, 'Internal Server Error');
    }
};


const wss = new WebSocketServer({ server, path: '/terminal/ws', verifyClient: verifyClient });
const userSessions = new Map();

wss.on('connection', (ws) => {
    const userId = generateUserId();
    const userSession = { ws, userId, ptyProcess: null, isActive: false };
    userSessions.set(userId, userSession);

    ws.on('message', (message) => {
        handleMessage(userSession, message);

    });
    ws.on('error', (err) => handleError(err, userId));
    ws.on('close', () => handleClose(userId));

});

const messageHandlers = {
    message: (session, data) => session.ptyProcess.write(data),
    resize: (session, { cols, rows }) => {
        cols = cols > 0 ? cols : 80;
        rows = rows > 0 ? rows : 30;
        session.ptyProcess.resize(cols, rows)
    },
    pause: (session) => session.ptyProcess.pause(),
    resume: (session) => session.ptyProcess.resume(),
    checkActive: (session, data) => {
        if (data === 'force' && session.isActive) {
            killPtyProcess(session.userId);
        } else {
            session.ws.send(session.isActive);
        }
    },
    command: (session, data) => handleCommand(session.ws, data, session.userId)
};

function handleMessage(userSession, message) {
    const parsed = parseMessage(message);
    if (!parsed) return;

    Object.entries(parsed).forEach(([key, value]) => {
        const handler = messageHandlers[key];
        if (handler && (userSession.isActive || key === 'checkActive' || key === 'command')) {
            handler(userSession, value);
        }
    });
}

function parseMessage(message) {
    try {
        return JSON.parse(message);
    } catch (e) {
        console.error('Failed to parse message:', e);
        return null;
    }
}

async function handleCommand(ws, command, userId) {
    const userSession = userSessions.get(userId);
    if (userSession && userSession.isActive) {
        const result = await killPtyProcess(userId);
        if (!result) {
            // if terminal is still active, even after we tried to kill it, dont continue and show error
            ws.send('unprocessable');
            return;
        }
    }

    const commandString = command[0].split('\n').join(' ');
    const timeout = extractTimeout(commandString);
    const sshArgs = extractSshArgs(commandString);
    const hereDocContent = extractHereDocContent(commandString);
    const options = {
        name: 'xterm-color',
        cols: 80,
        rows: 30,
        cwd: process.env.HOME,
        env: {},
    };

    // NOTE: - Initiates a process within the Terminal container
    //         Establishes an SSH connection to root@coolify with RequestTTY enabled
    //         Executes the 'docker exec' command to connect to a specific container
    const ptyProcess = pty.spawn('ssh', sshArgs.concat([hereDocContent]), options);

    userSession.ptyProcess = ptyProcess;
    userSession.isActive = true;

    ws.send('pty-ready');

    ptyProcess.onData((data) => {
        ws.send(data);
    });

    // when parent closes
    ptyProcess.onExit(({ exitCode, signal }) => {
        console.error(`Process exited with code ${exitCode} and signal ${signal}`);
        ws.send('pty-exited');
        userSession.isActive = false;

    });

    if (timeout) {
        setTimeout(async () => {
            await killPtyProcess(userId);
        }, timeout * 1000);
    }
}

async function handleError(err, userId) {
    console.error('WebSocket error:', err);
    await killPtyProcess(userId);
}

async function handleClose(userId) {
    await killPtyProcess(userId);
    userSessions.delete(userId);
}

async function killPtyProcess(userId) {
    const session = userSessions.get(userId);
    if (!session?.ptyProcess) return false;

    return new Promise((resolve) => {
        // Loop to ensure terminal is killed before continuing
        let killAttempts = 0;
        const maxAttempts = 5;

        const attemptKill = () => {
            killAttempts++;

            // session.ptyProcess.kill() wont work here because of https://github.com/moby/moby/issues/9098
            // patch with https://github.com/moby/moby/issues/9098#issuecomment-189743947
            session.ptyProcess.write('set +o history\nkill -TERM -$$ && exit\nset -o history\n');

            setTimeout(() => {
                if (!session.isActive || !session.ptyProcess) {
                    resolve(true);
                    return;
                }

                if (killAttempts < maxAttempts) {
                    attemptKill();
                } else {
                    resolve(false);
                }
            }, 500);
        };

        attemptKill();
    });
}

function generateUserId() {
    return Math.random().toString(36).substring(2, 11);
}

function extractTimeout(commandString) {
    const timeoutMatch = commandString.match(/timeout (\d+)/);
    return timeoutMatch ? parseInt(timeoutMatch[1], 10) : null;
}

function extractSshArgs(commandString) {
    const sshCommandMatch = commandString.match(/ssh (.+?) 'bash -se'/);
    let sshArgs = sshCommandMatch ? sshCommandMatch[1].split(' ') : [];
    sshArgs = sshArgs.map(arg => arg === 'RequestTTY=no' ? 'RequestTTY=yes' : arg);
    if (!sshArgs.includes('RequestTTY=yes')) {
        sshArgs.push('-o', 'RequestTTY=yes');
    }
    return sshArgs;
}

function extractHereDocContent(commandString) {
    const delimiterMatch = commandString.match(/<< (\S+)/);
    const delimiter = delimiterMatch ? delimiterMatch[1] : null;
    const escapedDelimiter = delimiter.slice(1).trim().replace(/[/\-\\^$*+?.()|[\]{}]/g, '\\$&');
    const hereDocRegex = new RegExp(`<< \\\\${escapedDelimiter}([\\s\\S\\.]*?)${escapedDelimiter}`);
    const hereDocMatch = commandString.match(hereDocRegex);
    return hereDocMatch ? hereDocMatch[1] : '';
}

server.listen(6002, () => {
    console.log('Coolify realtime terminal server listening on port 6002. Let the hacking begin!');
});
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify env | grep -i 'APP_NAME\|SESSION'"[?2004l
APP_NAME=Coolify
PHP_SESSION_COOKIE_SECURE=false
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "cat /opt [K//getouch/compose/docker-compose.coolify.yml"[?2004l
# Coolify â€” Self-hosted CI/CD platform
# Data persisted on SATA SSD at /data/coolify
#
# Usage:
#   cd /opt/getouch/compose
#   docker compose -f docker-compose.coolify.yml --env-file .env up -d
#
# Access:
#   https://coolify.getouch.co (via Cloudflare Tunnel â†’ Caddy)
#
# NOTE: Coolify by default uses port 8000 for its web UI.
#       We DO NOT expose this publicly. Caddy reverse-proxies to it.
#
# Services:
#   coolify        â€” Main Laravel app (UI + API)
#   coolify-db     â€” Dedicated PostgreSQL 15 for Coolify metadata
#   coolify-redis  â€” Redis for queues, cache, and session
#   coolify-realtime â€” Soketi WebSocket server (real-time UI updates)

services:
  # â”€â”€ PostgreSQL for Coolify â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  coolify-db:
    image: postgres:16-alpine
    container_name: coolify-db
    restart: unless-stopped
    environment:
      POSTGRES_USER: coolify
      POSTGRES_PASSWORD: ${COOLIFY_DB_PASSWORD:-coolify}
      POSTGRES_DB: coolify
      TZ: Asia/Kuala_Lumpur
    volumes:
      - /data/coolify/postgres:/var/lib/postgresql/data
    networks:
      - getouch_app
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U coolify -d coolify"]
      interval: 10s
      timeout: 5s
      retries: 5
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

  # â”€â”€ Redis for Coolify â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  coolify-redis:
    image: redis:7-alpine
    container_name: coolify-redis
    restart: unless-stopped
    command: redis-server --appendonly yes --save 60 1
    volumes:
      - /data/coolify/redis:/data
    networks:
      - getouch_app
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 5s
      retries: 5
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

  # â”€â”€ Soketi â€” Real-time WebSocket server â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Fixes "Cannot connect to real-time service" warning
  coolify-realtime:
    image: "ghcr.io/coollabsio/coolify-realtime:1.0.5"
    container_name: coolify-realtime
    restart: unless-stopped
    environment:
      SOKETI_DEBUG: "false"
      SOKETI_DEFAULT_APP_ID: coolify
      SOKETI_DEFAULT_APP_KEY: coolify
      SOKETI_DEFAULT_APP_SECRET: coolify
      SOKETI_PORT: "6001"
      SOKETI_METRICS_ENABLED: "false"
    ports:
      - "127.0.0.1:6001:6001"
    networks:
      - getouch_app
    healthcheck:
      test: ["CMD-SHELL", "curl -sf http://localhost:6001 || wget -qO- http://localhost:6001"]
      interval: 15s
      timeout: 5s
      retries: 5
      start_period: 10s
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

  # â”€â”€ Coolify main app â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  coolify:
    image: ghcr.io/coollabsio/coolify:latest
    container_name: coolify
    restart: unless-stopped
    depends_on:
      coolify-db:
        condition: service_healthy
      coolify-redis:
        condition: service_healthy
      coolify-realtime:
        condition: service_started
    environment:
      TZ: Asia/Kuala_Lumpur
      # Laravel app encryption key
      APP_KEY: "base64:7h4kT3ZGvGzf7txJWQbwpYWwEdYe6V0t6QQ22pF38bc="
      APP_NAME: Coolify
      APP_ENV: production
      APP_DEBUG: "false"
      # Database connection
      DB_HOST: coolify-db
      DB_PORT: "5432"
      DB_DATABASE: coolify
      DB_USERNAME: coolify
      DB_PASSWORD: ${COOLIFY_DB_PASSWORD:-coolify}
      # Redis connection
      REDIS_HOST: coolify-redis
      REDIS_PORT: "6379"
      REDIS_PASSWORD: ""
      # Pusher / Soketi real-time config (server-side broadcasting)
      PUSHER_APP_ID: coolify
      PUSHER_APP_KEY: coolify
      PUSHER_APP_SECRET: coolify
      PUSHER_SCHEME: http
      # PUSHER_HOST is intentionally UNSET so the browser JS
      # falls back to window.location.hostname (coolify.getouch.co)
      # PUSHER_PORT is intentionally UNSET so getRealtime() returns null
      # and the browser uses the default port (443 via Cloudflare wss)
      # Terminal config â€” routed through Caddy at /terminal/ws
      TERMINAL_PROTOCOL: wss
      TERMINAL_HOST: ""
      TERMINAL_PORT: ""
    volumes:
      - /data/coolify:/data/coolify
      - /data/coolify/ssh:/var/www/html/storage/app/ssh
      - /var/run/docker.sock:/var/run/docker.sock:ro
    extra_hosts:
      - "host.docker.internal:host-gateway"
    ports:
      # Only localhost â€” NOT public. Caddy handles ingress.
      - "127.0.0.1:8000:8080"
    networks:
      - getouch_app
    healthcheck:
      test: ["CMD", "curl", "-sf", "http://localhost:8080/api/health"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 60s
    logging:
      driver: json-file
      options:
        max-size: "20m"
        max-file: "5"

networks:
  getouch_app:
    external: true
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "sed -i ' [K//SOKETI_METRICS_ENABLED/a\\      APP_NAME: Coolify' /opt/getouch/compose/do [Kccker-compose.coolify.yml && grep -A 12 'coolify-realtime:' /opt/getouch/com [Kppose/docker-compose.coolify.yml | head -15"[?2004l
  coolify-realtime:
    image: "ghcr.io/coollabsio/coolify-realtime:1.0.5"
    container_name: coolify-realtime
    restart: unless-stopped
    environment:
      SOKETI_DEBUG: "false"
      SOKETI_DEFAULT_APP_ID: coolify
      SOKETI_DEFAULT_APP_KEY: coolify
      SOKETI_DEFAULT_APP_SECRET: coolify
      SOKETI_PORT: "6001"
      SOKETI_METRICS_ENABLED: "false"
      APP_NAME: Coolify
    ports:
      - "127.0.0.1:6001:6001"
--
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "cd /opt/ [Kggetouch/compose && docker compose -f docker-compose.coolify.yml up -d cooli [Kffy-realtime" 2>&1[?2004l
time="2026-02-17T10:24:09Z" level=warning msg="Found orphan containers ([landing ollama comfyui pgadmin postgres prometheus grafana cadvisor node-exporter compose-cloudflared-1 compose-caddy-1 compose-whoami-1 postgres-ssd bot wa api]) for this project. If you removed or renamed this service in your compose file, you can run this command with the --remove-orphans flag to clean it up."
 Container coolify-realtime Recreate 
 Container coolify-realtime Recreated 
 Container coolify-realtime Starting 
 Container coolify-realtime Started 
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "sleep 5  [K&&& docker logs coolify-realtime --tail 10 2>&1"[?2004l
2026-02-17 10:24:10 [SOKETI] ðŸŽ‰ Server is up and running!
2026-02-17 10:24:10 [SOKETI] ðŸ“¡ The Websockets server is available at 127.0.0.1:6001
2026-02-17 10:24:10 [SOKETI] ðŸ”— The HTTP API server is available at http://127.0.0.1:6001
2026-02-17 10:24:10 [SOKETI] ðŸŽŠ The /usage endpoint is available on port 9601.
2026-02-17 10:24:10 [SOKETI] 
2026-02-17 10:24:10 [SOKETI] (node:9) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.
2026-02-17 10:24:10 [SOKETI] 
2026-02-17 10:24:10 [SOKETI] Please migrate your code to use AWS SDK for JavaScript (v3).
2026-02-17 10:24:10 [SOKETI] For more information, check the migration guide at https://a.co/7PzMCcy
2026-02-17 10:24:10 [SOKETI] (Use `node --trace-warnings ...` to show where the warning was created)
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker l [Koogs coolify-realtime 2>&1 | tail -15"[?2004l
2026-02-17 10:24:10 [TERMINAL] Coolify realtime terminal server listening on port 6002. Let the hacking begin!
2026-02-17 10:24:10 [SOKETI] 
2026-02-17 10:24:10 [SOKETI] ðŸ•µï¸â€â™‚ï¸ Initiating metrics endpoints...
2026-02-17 10:24:10 [SOKETI] 
2026-02-17 10:24:10 [SOKETI] ðŸŽ‰ Server is up and running!
2026-02-17 10:24:10 [SOKETI] ðŸ“¡ The Websockets server is available at 127.0.0.1:6001
2026-02-17 10:24:10 [SOKETI] ðŸ”— The HTTP API server is available at http://127.0.0.1:6001
2026-02-17 10:24:10 [SOKETI] ðŸŽŠ The /usage endpoint is available on port 9601.
2026-02-17 10:24:10 [SOKETI] 
2026-02-17 10:24:10 [SOKETI] (node:9) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.
2026-02-17 10:24:10 [SOKETI] 
2026-02-17 10:24:10 [SOKETI] Please migrate your code to use AWS SDK for JavaScript (v3).
2026-02-17 10:24:10 [SOKETI] For more information, check the migration guide at https://a.co/7PzMCcy
2026-02-17 10:24:10 [SOKETI] (Use `node --trace-warnings ...` to show where the warning was created)
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify-realtime wget -q -O- http://coolify:8080/terminal/auth 2>&1 | h [Keead -5; echo '---'; docker exec coolify-realtime env | grep APP_NAME"[?2004l
<!DOCTYPE html>
<html data-theme="dark" lang="en">
<script>
    // Immediate theme application - runs before any rendering
    (function () {
---
APP_NAME=Coolify
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify-realtime wget -q -O- --header='Cookie: test=1' --post-data='' h [Ktttp://coolify:8080/terminal/auth 2>&1 | head -3"[?2004l
wget: server returned error: HTTP/1.1 419 unknown status
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify php artisan tinker --execute=\"[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'PUSHER_HOST: ' . env('PUSHER_HOST', 'NOT SET') . PHP_EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'PUSHER_PORT: ' . env('PUSHER_PORT', 'NOT SET') . PHP_EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'Broadcasting driver: ' . config('broadcasting.default') . PHP [K__EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'Pusher config host: ' . config('broadcasting.connections.push [Keer.options.host', 'NOT SET') . PHP_EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'Pusher config port: ' . config('broadcasting.connections.push [Keer.options.port', 'NOT SET') . PHP_EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004h\\""[?2004l
Restricted Mode: skipping untrusted project features from /var/www/html (non-interactive mode). Use --trust-project to allow.
PUSHER_HOST: NOT SET
PUSHER_PORT: NOT SET
Broadcasting driver: pusher
Pusher config host: coolify-realtime
Pusher config port: 6001
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify grep -rl 'sentinel_token\|sentinel' /var/www/html/app/Livewire/ [KSServer/ 2>/dev/null | head -5"[?2004l
/var/www/html/app/Livewire/Server/Show.php
/var/www/html/app/Livewire/Server/Sentinel.php
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify grep -n 'sentinel_token\|validate\|rules\|required' /var/www/ht [Kmml/app/Livewire/Server/Sentinel.php | head -30"[?2004l
22:    #[Validate(['required'])]
27:    #[Validate(['required', 'integer', 'min:1'])]
30:    #[Validate(['required', 'integer', 'min:1'])]
33:    #[Validate(['required', 'integer', 'min:10'])]
69:            $this->validate();
71:            $this->server->settings->sentinel_token = $this->sentinelToken;
81:            $this->sentinelToken = $this->server->settings->sentinel_token;
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify head -100 /var/www/html/app/Livewire/Server/Sentinel.php"[?2004l
<?php

namespace App\Livewire\Server;

use App\Actions\Server\StartSentinel;
use App\Actions\Server\StopSentinel;
use App\Models\Server;
use Illuminate\Foundation\Auth\Access\AuthorizesRequests;
use Livewire\Attributes\Validate;
use Livewire\Component;

class Sentinel extends Component
{
    use AuthorizesRequests;

    public Server $server;

    public array $parameters = [];

    public bool $isMetricsEnabled;

    #[Validate(['required'])]
    public string $sentinelToken;

    public ?string $sentinelUpdatedAt = null;

    #[Validate(['required', 'integer', 'min:1'])]
    public int $sentinelMetricsRefreshRateSeconds;

    #[Validate(['required', 'integer', 'min:1'])]
    public int $sentinelMetricsHistoryDays;

    #[Validate(['required', 'integer', 'min:10'])]
    public int $sentinelPushIntervalSeconds;

    #[Validate(['nullable', 'url'])]
    public ?string $sentinelCustomUrl = null;

    public bool $isSentinelEnabled;

    public bool $isSentinelDebugEnabled;

    public ?string $sentinelCustomDockerImage = null;

    public function getListeners()
    {
        $teamId = $this->server->team_id ?? auth()->user()->currentTeam()->id;

        return [
            "echo-private:team.{$teamId},SentinelRestarted" => 'handleSentinelRestarted',
        ];
    }

    public function mount(string $server_uuid)
    {
        try {
            $this->server = Server::ownedByCurrentTeam()->whereUuid($server_uuid)->firstOrFail();
            $this->parameters = get_route_parameters();
            $this->syncData();
        } catch (\Throwable) {
            return redirect()->route('server.index');
        }
    }

    public function syncData(bool $toModel = false)
    {
        if ($toModel) {
            $this->authorize('update', $this->server);
            $this->validate();
            $this->server->settings->is_metrics_enabled = $this->isMetricsEnabled;
            $this->server->settings->sentinel_token = $this->sentinelToken;
            $this->server->settings->sentinel_metrics_refresh_rate_seconds = $this->sentinelMetricsRefreshRateSeconds;
            $this->server->settings->sentinel_metrics_history_days = $this->sentinelMetricsHistoryDays;
            $this->server->settings->sentinel_push_interval_seconds = $this->sentinelPushIntervalSeconds;
            $this->server->settings->sentinel_custom_url = $this->sentinelCustomUrl;
            $this->server->settings->is_sentinel_enabled = $this->isSentinelEnabled;
            $this->server->settings->is_sentinel_debug_enabled = $this->isSentinelDebugEnabled;
            $this->server->settings->save();
        } else {
            $this->isMetricsEnabled = $this->server->settings->is_metrics_enabled;
            $this->sentinelToken = $this->server->settings->sentinel_token;
            $this->sentinelMetricsRefreshRateSeconds = $this->server->settings->sentinel_metrics_refresh_rate_seconds;
            $this->sentinelMetricsHistoryDays = $this->server->settings->sentinel_metrics_history_days;
            $this->sentinelPushIntervalSeconds = $this->server->settings->sentinel_push_interval_seconds;
            $this->sentinelCustomUrl = $this->server->settings->sentinel_custom_url;
            $this->isSentinelEnabled = $this->server->settings->is_sentinel_enabled;
            $this->isSentinelDebugEnabled = $this->server->settings->is_sentinel_debug_enabled;
            $this->sentinelUpdatedAt = $this->server->sentinel_updated_at;
        }
    }

    public function handleSentinelRestarted($event)
    {
        if ($event['serverUuid'] === $this->server->uuid) {
            $this->server->refresh();
            $this->syncData();
            $this->dispatch('success', 'Sentinel has been restarted successfully.');
        }
    }

[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec compose-caddy-1 caddy reload --config /etc/caddy/Caddyfile 2>&1 || dock [Keer restart compose-caddy-1 2>&1"[?2004l
{"level":"info","ts":1771323963.6223035,"msg":"using config from file","file":"/etc/caddy/Caddyfile"}
{"level":"info","ts":1771323963.6239796,"msg":"adapted config to JSON","adapter":"caddyfile"}
{"level":"warn","ts":1771323963.6239843,"msg":"Caddyfile input is not formatted; run 'caddy fmt --overwrite' to fix inconsistencies","adapter":"caddyfile","file":"/etc/caddy/Caddyfile","line":4}
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "echo '== [K== Container Status ===' && docker ps --format 'table {{.Names}}\t{{.Status} [K}}' | grep coolify && echo '' && echo '=== Coolify Health ===' && curl -sf h [Ktttp://localhost:8000/api/health 2>&1 && echo '' && echo '=== Caddy Routes T [Keest ===' && curl -sf -H 'Host: coolify.getouch.co' http://localhost:80/api/ [Khhealth 2>&1 && echo '' && echo '=== Realtime Health ===' && curl -sf http:/ [K//localhost:6001 2>&1 && echo '' && echo '=== DB Encryption Check ===' && do [Kccker exec coolify php artisan tinker --execute=\"[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'private_keys: ';[?2004l
[0m[27m[24m[Jdquote> [K[?2004httry { \\\$k = App\Models\PrivateKey::first(); echo (\\\$k && \\\$k- [K>>private_key ? 'OK' : 'EMPTY') . PHP_EOL; } catch(\Throwable \\\$e) { echo  [K''FAIL: ' . \\\$e->getMessage() . PHP_EOL; }[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'sentinel_token (server 1): ';[?2004l
[0m[27m[24m[Jdquote> [K[?2004httry { \\\$s = App\Models\ServerSetting::where('server_id', 1)->firs [Ktt(); echo (\\\$s && \\\$s->sentinel_token ? 'OK' : 'EMPTY') . PHP_EOL; } ca [Kttch(\Throwable \\\$e) { echo 'FAIL: ' . \\\$e->getMessage() . PHP_EOL; }[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'sentinel_token (server 0): ';[?2004l
[0m[27m[24m[Jdquote> [K[?2004httry { \\\$s = App\Models\ServerSetting::where('server_id', 0)->firs [Ktt(); echo (\\\$s && \\\$s->sentinel_token ? 'OK' : 'EMPTY') . PHP_EOL; } ca [Kttch(\Throwable \\\$e) { echo 'FAIL: ' . \\\$e->getMessage() . PHP_EOL; }[?2004l
[0m[27m[24m[Jdquote> [K[?2004h\\""[?2004l
=== Container Status ===
coolify-realtime        Up 2 minutes (healthy)
coolify-sentinel        Up 8 minutes (healthy)
coolify                 Up 34 minutes (healthy)
coolify-db              Up 41 minutes (healthy)
coolify-redis           Up 41 minutes (healthy)

=== Coolify Health ===
OK
=== Caddy Routes Test ===
OK
=== Realtime Health ===
OK
=== DB Encryption Check ===
Restricted Mode: skipping untrusted project features from /var/www/html (non-interactive mode). Use --trust-project to allow.
private_keys: OK
sentinel_token (server 1): OK
sentinel_token (server 0): OK
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker i [Knnspect coolify-sentinel --format '{{.Config.Image}}' 2>&1; docker logs cool [Kiify-realtime 2>&1 | tail -5"[?2004l
ghcr.io/coollabsio/sentinel:0.0.18
2026-02-17 10:24:10 [SOKETI] (node:9) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.
2026-02-17 10:24:10 [SOKETI] 
2026-02-17 10:24:10 [SOKETI] Please migrate your code to use AWS SDK for JavaScript (v3).
2026-02-17 10:24:10 [SOKETI] For more information, check the migration guide at https://a.co/7PzMCcy
2026-02-17 10:24:10 [SOKETI] (Use `node --trace-warnings ...` to show where the warning was created)
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify php artisan tinker --execute=\"[?2004l
[0m[27m[24m[Jdquote> [K[?2004huuse Illuminate\Support\Facades\DB;[?2004l
[0m[27m[24m[Jdquote> [K[?2004h\\\\$servers = DB::table('servers')->select(['id','name','ip','user' [K,,'port'])->get();[?2004l
[0m[27m[24m[Jdquote> [K[?2004hfforeach (\\\$servers as \\\$s) {[?2004l
[0m[27m[24m[Jdquote> [K[?2004h     echo \\\"Server id={\\\$s->id} name={\\\$s->name} ip={\\\$s->ip [K}} user={\\\$s->user} port={\\\$s->port}\\\" . PHP_EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004h}[?2004l
[0m[27m[24m[Jdquote> [K[?2004h\\""[?2004l
Server id=1 name=Getouch-Coolify ip=host.docker.internal user=deploy port=22
Server id=0 name=localhost ip=host.docker.internal user=deploy port=22
Restricted Mode: skipping untrusted project features from /var/www/html (non-interactive mode). Use --trust-project to allow.
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify php artisan tinker --execute=\"[?2004l
[0m[27m[24m[Jdquote> [K[?2004huuse Illuminate\Support\Facades\DB;[?2004l
[0m[27m[24m[Jdquote> [K[?2004hDDB::table('servers')->where('id', 1)->update(['ip' => '100.103.248. [K115']);[?2004l
[0m[27m[24m[Jdquote> [K[?2004h\\\\$s = DB::table('servers')->where('id', 1)->first();[?2004l
[0m[27m[24m[Jdquote> [K[?2004heecho 'Server id=1 ip now: ' . \\\$s->ip . PHP_EOL;[?2004l
[0m[27m[24m[Jdquote> [K[?2004h\\""[?2004l
Restricted Mode: skipping untrusted project features from /var/www/html (non-interactive mode). Use --trust-project to allow.
Server id=1 ip now: 100.103.248.15
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004h  ssh deploy@100.103.248.15 "docker e [Kxxec coolify php artisan cache:clear" 2>&1[?2004l

   INFO  Application cache cleared successfully.  

[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air getouch % [K[?2004hccd ..[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air ~ % [K[?2004hlls[?2004l
Applications		Library			eclipse
Desktop			Movies			eclipse-workspace
Documents		Music			getouch
Downloads		Pictures		serapod2u_new
HR			Public
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air ~ % [K[?2004hmmkdir systemqr[?2004l
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air ~ % [K[?2004h[7mcd ~/Projects[27m
[7mgit clone https://github.com/edierwan/systemqr.com.git[27m[K
[7mcode systemqr.com[27m[K
[K[3A[33C[27mc[27md[27m [27m~[27m/[27mP[27mr[27mo[27mj[27me[27mc[27mt[27ms[1B[27mg[27mi[27mt[27m [27mc[27ml[27mo[27mn[27me[27m [27mh[27mt[27mt[27mp[27ms[27m:[27m/[27m/[27mg[27mi[27mt[27mh[27mu[27mb[27m.[27mc[27mo[27mm[27m/[27me[27md[27mi[27me[27mr[27mw[27ma[27mn[27m/[27ms[27my[27ms[27mt[27me[27mm[27mq[27mr[27m.[27mc[27mo[27mm[27m.[27mg[27mi[27mt[1B[27mc[27mo[27md[27me[27m [27ms[27my[27ms[27mt[27me[27mm[27mq[27mr[27m.[27mc[27mo[27mm[1B[K[A[17C              c [K[K[A[54C                                                  g [K[K[A[46C          c  ccd systemqr[1m/[0m[0m [?2004l[1B[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air systemqr % [K[?2004h[7mgit clone https://github.com/edierw[7ma[7mn/systemqr.com.git[27m[K
[7mcode systemqr.com[27m[K[A[A[23C[27mg[27mi[27mt[27m [27mc[27ml[27mo[27mn[27me[27m [27mh[27mt[27mt[27mp[27ms[27m:[27m/[27m/[27mg[27mi[27mt[27mh[27mu[27mb[27m.[27mc[27mo[27mm[27m/[27me[27md[27mi[27me[27mr[27mwa[27mn[27m/[27ms[27my[27ms[27mt[27me[27mm[27mq[27mr[27m.[27mc[27mo[27mm[27m.[27mg[27mi[27mt[1B[27mc[27mo[27md[27me[27m [27ms[27my[27ms[27mt[27me[27mm[27mq[27mr[27m.[27mc[27mo[27mm[?2004l
Cloning into 'systemqr.com'...
remote: Enumerating objects: 3, done.[K
remote: Counting objects:  33% (1/3)[Kremote: Counting objects:  66% (2/3)[Kremote: Counting objects: 100% (3/3)[Kremote: Counting objects: 100% (3/3), done.[K
remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0 (from 0)[K
Receiving objects:  33% (1/3)Receiving objects:  66% (2/3)Receiving objects: 100% (3/3)Receiving objects: 100% (3/3), done.
zsh: command not found: code
[1m[7m%[27m[1m[0m                                                                           [0m[27m[24m[Jmacbook@Macbooks-MacBook-Air systemqr % [K[?2004h